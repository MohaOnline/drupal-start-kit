<?php

/**
 * @file
 * Provides a method of generating the service catalog for external services.
 *
 * E.g. for services like eHerkenning and eIDAS.
 */

/**
 * Implements hook_menu().
 *
 * {@inheritdoc}
 */
function dvg_authentication_service_catalog_menu() {
  $items = [];
  $items['admin/config/services/dvg-authentication/service-catalog'] = [
    'title' => 'Service Catalog',
    'description' => 'Generate the service catalog for SAML authenticated eToegang services.',
    'page callback' => 'drupal_get_form',
    'page arguments' => ['dvg_authentication_service_catalog_form'],
    'access arguments' => ['access authentication administration pages'],
    'file' => 'includes/dvg_authentication_service_catalog.admin.inc',
  ];

  $items['admin/config/services/dvg-authentication/service-catalog/metadata/%'] = [
    'title' => 'Download metadata',
    'description' => 'Provides a simple download for metadata of a configure simplesaml service.',
    'page callback' => 'dvg_authentication_service_catalog_metadata_download',
    'page arguments' => [6],
    // SAML metadata is intended to be available to everybody.
    'access callback' => TRUE,
    'file' => 'includes/dvg_authentication_service_catalog.admin.inc',
  ];

  return $items;
}

/**
 * Implements hook_theme().
 *
 * {@inheritdoc}
 */
function dvg_authentication_service_catalog_theme($existing, $type, $theme, $path) {
  return [
    'authentication_service_catalog' => [
      'variables' => [
        'oin' => NULL,
        'organisation_name' => NULL,
        'organisation_url' => NULL,
        'idp' => NULL,
        'services' => [],
      ],
      'path' => $path . '/templates',
      'template' => 'dvg-authentication-service-catalog',
    ],
  ];
}

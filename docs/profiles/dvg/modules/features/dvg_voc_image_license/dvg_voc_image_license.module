<?php
/**
 * @file
 * Code for the Taxonomy: Image license feature.
 */

include_once 'dvg_voc_image_license.features.inc';
include_once 'dvg_voc_image_license.dvg.user_permission.inc';

/**
 * Implements hook_field_display_ENTITY_TYPE_alter().
 */
function dvg_voc_image_license_preprocess_field(&$variables) {
  $element = $variables['element'];

  if ($element['#field_name'] == 'field_file_url') {
    $file = $element['#object'];
    $field = field_get_items('file', $file, 'field_file_url');

    if ($field[0]['title'] == $field[0]['url']) {
      $variables['label_hidden'] = TRUE;
      $variables['items'][0]['#element']['title'] = $variables['label'];
    }
  }
}

/**
 * Implements hook_form_FORM_ID_alter().
 */
function dvg_voc_image_license_form_taxonomy_form_term_alter(&$form, &$form_state, $form_id) {
  if (!empty($form['#bundle']) && $form['#bundle'] == 'image_license') {
    $form['description']['#access'] = FALSE;
    $form['relations']['#access'] = FALSE;
  }
}
/**
 * Implements hook_dvg_requirements().
 */
function dvg_voc_image_license_dvg_requirements() {
  return _dvg_global_voc_requirements('image_license', t('Image license'));
}
